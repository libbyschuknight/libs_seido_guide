<%= render "layouts/heading", heading: "STANCES" %>

<div class="row">
  <div class="col">
    <h2 class="title"><%= @stance.japanese_name %></h2>
    <h3><%= @stance.english_name %></h3>
    <p class="description"><%= @stance.description %></p>

    <% if @stance.previous %>
      <%= link_to "previous", @stance.previous, :class => "btn btn-default", :role => "button" %>
    <% end %>

    <% if @stance.next %>
      <%= link_to "next", @stance.next, :class => "btn btn-default", :role => "button" %>
    <% end %>

    <%= link_to "first", @first_stance, :class => "btn btn-default", :role => "button" %>

    <%= link_to "last", @last_stance, :class => "btn btn-default", :role => "button" %>
    <p> </p>

    <%= image_tag @stance.image(:large), { class: "center-block thumbnail" } %>
    <%= link_to 'Edit', edit_stance_path(@stance), :class => "btn btn-default", :role => "button" %>
    <%= link_to "Back", stances_path,  :class => "btn btn-default", :role => "button" %>

  </div>

  <% if @stance.user %>
    <ul class="listing">
      <div class="row center">
        <div class="col-md-4 col-md-offset-4">
          <li>Created by:</li>
          <li>
            <%= link_to gravatar_for(@stance.user), user_path(@stance.user) %>
          </li>
          <li class="stance-title">
            <%= link_to @stance.user.username, user_path(@stance.user) %>
          </li>
          <li>
            <small>
              <%= pluralize(@stance.user.stances.count, "stance") if @stance.user.stances %>
            </small>
          </li>
        </div>
      </div>
    </ul>
  <% end %>

  <% if logged_in? && (current_user == stance.user || current_user.admin?) %>
    <div class="stance-actions">
      <%= link_to "Edit", edit_stance_path(stance), class: "btn btn-xs btn-primary" %>
      <%= link_to "Delete", stance_path(stance),
          method: :delete,
          data: { confirm: "Are you sure you want to delete the stance?" },
          class: "btn btn-xs btn-danger"
      %>
    </div>
  <% end %>

</div>


<!-- error message not working? -->
<% if @stance.errors.any? %>
  <div class="panel panel-warning errors">
    <div class="panel-heading">
      <h5><i class="glyphicon glyphicon-exclamation-sign"></i> Found errors while saving</h5>
    </div>

    <ul class="panel-body">
      <% @stance.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>
